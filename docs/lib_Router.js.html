<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: lib/Router.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: lib/Router.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict';

let methods  = require( 'methods' );
let rethrow  = require( './internal/rethrow' );
let Response = require( './Response' );
let Route    = require( './Route' );

/**
 * @constructor module:router.Router
 * @example
 * let Router = require( 'router/lib/Router' );
 * let router = new Router();
 */
function Router () {
  this.settings = {
    'view caching': false,
    'view layout': null,
    'view engine': null,
    'views': 'views'
  };

  this.routes = [];
}

Router.prototype = {
  /**
   * @method module:router.Router#use
   * @param {string}                            [path="*"]
   * @param {...(function|module:router.Route)} handlers
   * @chainable
   * @example
   * router
   *   .use( logger )
   *   .use( '/', bodyParser.json() )
   *   .use( '/', bodyParser.urlencoded( { extended: false } ) )
   *   .use( helmet() );
   *
   * function logger ( request, response, next ) {
   *   console.log( request.method, request.url );
   *   next();
   * }
   */
  use ( path ) {
    let offset;

    if ( typeof path === 'string' || path instanceof RegExp ) {
      offset = 1;
    } else {
      path = '*';
      offset = 0;
    }

    for ( ; offset &lt; arguments.length; ++offset ) {
      let handler = arguments[ offset ];

      if ( handler instanceof Route === false ) {
        handler = new Route( path ).all( handler );
      }

      this.routes.push( handler );
    }

    return this;
  },

  /**
   * @method module:router.Router#handle
   * @param  {http.IncomingMessage} request
   * @param  {http.ServerResponse}  response
   * @return {void}
   * @example
   * http.createServer( router.handle.bind( router ) );
   */
  handle ( request, response ) {
    let self  = this;
    let index = 0;

    Response.update( response, { request, router: this } );

    function next ( error ) {
      for ( let length = self.routes.length; index &lt; length; ) {
        let route = self.routes[ index++ ];

        if ( ! route._handles( request, error ) ) {
          continue;
        }

        return route
          ._process( request )
          ._handle( request, response, next, error );
      }

      rethrow( error );
    }

    next();
  },

  /**
   * @method module:router.Router#set
   * @param {string} key
   * @param {any}    value
   * @chainable
   * @example
   * router.set( 'view caching', true );
   */
  set ( key, value ) {
    this.settings[ key ] = value;
    return this;
  },

  constructor: Router
};

methods.concat( 'all' ).forEach( ( lowerMethod ) => {
  Router.prototype[ lowerMethod ] = function ( path, handler ) {
    this.routes.push( new Route( path )[ lowerMethod ]( handler ) );
    return this;
  };
} );

module.exports = Router;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-router.html">router</a></li></ul><h3>Classes</h3><ul><li><a href="module-router.Response.html">Response</a></li><li><a href="module-router.Route.html">Route</a></li><li><a href="module-router.Router.html">Router</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Wed Aug 29 2018 00:03:19 GMT+0700 (+07)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
